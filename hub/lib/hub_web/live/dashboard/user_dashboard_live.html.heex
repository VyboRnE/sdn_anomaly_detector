<div class="space-y-6">

  <div class="mb-4">
    <button phx-click="add_sensor" class="btn btn-primary">
      ‚ûï –î–æ–¥–∞—Ç–∏ —Å–µ–Ω—Å–æ—Ä
    </button>
  </div>

  <!-- –¢–∞–±–ª–∏—Ü—è —Å–µ–Ω—Å–æ—Ä—ñ–≤ -->
  <table class="table-auto w-full border-collapse border border-gray-400">
    <thead>
      <tr class="bg-gray-200">
        <th class="border border-gray-300 px-4 py-2 text-left">–ù–∞–∑–≤–∞</th>
        <th class="border border-gray-300 px-4 py-2 text-left">ID</th>
        <th class="border border-gray-300 px-4 py-2 text-left">API Key</th>
      </tr>
    </thead>
    <tbody>
      <%= for sensor <- @sensors do %>
        <tr
          phx-click="select_sensor"
          phx-value-sensor_id={sensor.id}
          class={"cursor-pointer hover:bg-gray-100 " <> if @selected_sensor && sensor.id == @selected_sensor.id, do: "bg-blue-100", else: ""}
        >
          <td class="border border-gray-300 px-4 py-2"><%= sensor.name %></td>
          <td class="border border-gray-300 px-4 py-2"><%= sensor.api_key || "‚Äì" %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <!-- –î–µ—Ç–∞–ª—ñ —Å–µ–Ω—Å–æ—Ä–∞ -->
  <%= if @selected_sensor do %>
    <div class="p-4 border rounded-lg shadow-md bg-white">
      <h2 class="text-xl font-semibold mb-2">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ–Ω—Å–æ—Ä</h2>
      <p><strong>–ù–∞–∑–≤–∞:</strong> <%= @selected_sensor.name %></p>
      <p><strong>ID:</strong> <%= @selected_sensor.id %></p>
      <p><strong>API –∫–ª—é—á:</strong> <%= @selected_sensor.api_key || "–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ" %></p>

      <h3 class="text-lg font-medium mt-4 mb-2">–ì—Ä–∞—Ñ—ñ–∫ —Ç—Ä–∞—Ñ—ñ–∫—É</h3>
      <%= if @stats && Enum.any?(@stats) do %>
        <div
          id="trafficCanvas"
          phx-hook="TrafficChart"
          data-chart={Jason.encode!(%{
            timestamps: Enum.map(@stats, & &1.timestamp),
            values: Enum.map(@stats, & &1.value)
          })}
        >
        </div>
      <% else %>
        <p>–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è —Ü—å–æ–≥–æ —Å–µ–Ω—Å–æ—Ä–∞.</p>
      <% end %>
    </div>
  <% else %>
    <p>–û–±–µ—Ä—ñ—Ç—å —Å–µ–Ω—Å–æ—Ä –∑—ñ —Å–ø–∏—Å–∫—É –≤–∏—â–µ, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –¥–µ—Ç–∞–ª—ñ.</p>
  <% end %>


  <%= if @show_add_form do %>
  <div class="p-4 border rounded-md shadow bg-gray-50">
    <h3 class="text-lg font-semibold mb-2">–ù–æ–≤–∏–π —Å–µ–Ω—Å–æ—Ä</h3>
    <form phx-submit="save_sensor">
      <input
        type="text"
        name="sensor[name]"
        placeholder="–ù–∞–∑–≤–∞ —Å–µ–Ω—Å–æ—Ä–∞"
        class="border px-2 py-1 rounded w-1/2 mb-2"
      />
      <br />
      <button type="submit" class="btn btn-success">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    </form>
  </div>
<% end %>
</div>